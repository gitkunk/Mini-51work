C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Driver) DEBUG OBJECTEXTEND PRI
                    -NT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2          ç®€æ˜“çš„æ—¶é’Ÿå½©ç¯éŸ³ä¹ç›’
   3          æ—¥æœŸï¼š2024-06-6
   4          ä½œè€…ï¼š1632242111031
   5          å‚è€ƒï¼šSTC89C52ç¡¬ä»¶ç”µè·¯åŸç†å›¾
   6          
   7          Simple real-time music box system with color lights
   8          Date: 2024-06-6
   9          Author: I roasted sweet potatoes in Fuzhou
  10          Reference: STC89C52 hardware circuit schematic
  11          Description: Please don't COPY.
  12          anti-counterfeiting will be prosecuted
  13          */
  14          
  15          /*â­â­â­â­â­â­â­â­Welcome to the works of sweet potatoâ­â­â­â­â­â­â­â­â­â­*/
  16          
  17          #include <REGX52.H>//51ç‰¹æ®Šå¯„å­˜å™¨å®šä¹‰ç›¸å…³å¤´æ–‡ä»¶
  18          #include <Kunkunmv.h>//ç‚¹é˜µå±å¤´æ–‡ä»¶
  19          #include <INTRINS.H>//nopå»¶æ—¶å‡½æ•°æ‰€åœ¨å¤´æ–‡ä»¶
  20          #include <DS18B20.h>//æ¸©åº¦ä¼ æ„Ÿå™¨å¤´æ–‡ä»¶
  21          #include <OneWire.h>//å•æ€»çº¿å¤´æ–‡ä»¶
  22          #include <ds1302.h>//ds1302å¤´æ–‡ä»¶
  23          #include <SPI.h>//ADè½¬æ¢-->SPIé€šè®¯å¤´æ–‡ä»¶
  24          #include <Key.h>//æŒ‰é”®åº•å±‚åˆ¤æ–­å¤´æ–‡ä»¶
  25          #include <Led.h>//ledé—ªçƒå¤´æ–‡ä»¶
  26          #include <iic.h>//iicå¤´æ–‡ä»¶
  27          #include <Seg.h>//æ•°ç ç®¡åº•å±‚å¤´æ–‡ä»¶
  28          
  29          /*ç³»ç»Ÿå¯åŠ¨å¼€å…³*/
  30          bit System_Begin;
  31          /*ä¸Šç”µæµæ°´ç¯å‚æ•°*/
  32          bit Led_Light;
  33          /*æŒ‰é”®,æ•°ç ç®¡æ˜¾ç¤º,LEDæµæ°´ç¯,æ—¶é’Ÿå‚æ•°*/
  34          unsigned char Seg_Disp_Page = 0;
  35          unsigned char Key_Slow_Down,Seg_Slow_Down;            //æŒ‰é”®åŠæ•°ç ç®¡å‡é€Ÿå‚æ•°
  36          unsigned char Key_Val,Key_Down,Key_Up,Key_Old;        //æŒ‰é”®å‚æ•°(ä¸Šå‡ï¼Œä¸‹é™æ²¿)
  37          unsigned char Seg_Buf[8] = {10,10,10,10,10,10,10,10}; //æ•°ç ç®¡æ®µç æ˜¾ç¤º
  38          unsigned char Seg_Point[8] = {0,0,0,0,0,0,0,0};       //æ•°ç ç®¡å°æ•°ç‚¹æ˜¾ç¤ºæ•°ç»„
  39          unsigned char ucLed[8] = {0,0,0,0,0,0,0,0};           //Ledæ˜¾ç¤ºæ•°ç»„
  40          unsigned char Led_Wela[2][8] = {{0XFE,0XFD,0XFB,0XF7,0XEF,0XDF,0XBF,0X7F},//LedèŠ±å¼ç‚¹äº®æ®µç 
  41                                          {0X7E,0XBD,0XDB,0XE7,0XE7,0XDB,0XBD,0X7E}};//å‰å››ä½0-7,1-6,2-5,3-4äº®
  42          unsigned char uc_Rtc[3] = {0X23,0X59,0X55};           //æ—¶é’Ÿåˆå§‹å€¼
  43          unsigned char LED_OR_SEG_OR_BEEP;                     //LED/æ•°ç ç®¡/èœ‚é¸£å™¨ ä¸‰å¤§æ¨¡å¼é€‰æ‹©æ ‡å¿—ä½ 0- LE
             -Dæµè½¬æ¨¡å¼ 1-æ•°ç ç®¡æ˜¾ç¤ºæ¨¡å¼ 2-éŸ³ä¹æ’­æ”¾æ¨¡å¼
  44          unsigned char Seg_Disp_Page;    //æ•°ç ç®¡å­ç•Œé¢åˆ‡æ¢å‚æ•° 0-æ—¶é’Ÿæ˜¾ç¤ºç•Œé¢,1-é£æ‰‡ç­‰çº§æ˜¾ç¤ºç•
             -Œé¢,2-æ¸©åº¦æ˜¾ç¤ºç•Œé¢,3-LEDæµè½¬å‚æ•°è®¾ç½®ç•Œé¢
  45          unsigned char Seg_Pos;          //æ•°ç ç®¡æ‰«æä½
  46          /*LEDèŠ±å¼ç‚¹äº®æ˜¾ç¤ºç›¸å…³å‚æ•°*/
  47          bit Led_Page_Choose;            //æµè½¬æ˜¾ç¤ºç•Œé¢-->æµè½¬è®¾ç½®ç•Œé¢ åˆ‡æ¢æŒ‰é”®
  48          bit Led_Dat_Choose;             //LEDæµè½¬å‚æ•°æ“ä½œé€‰æ‹©æŒ‰é”® 0-äº®åº¦ç­‰çº§è®¾ç½®,1-æµè½¬æ—¶é—´è®¾ç½®
  49          bit Light_Disp;                 //ç­‰çº§(äº®åº¦/ç”µå‹/å…‰æ•/çƒ­æ•/å¤–éƒ¨ç”µå‹)å‚æ•°æ˜¾ç¤ºæ ‡å¿—ä½ 0-ç­ 1-äº
             -® 
  50          unsigned int Led_Ctro = 400;    //æµè½¬æ—¶é—´æ§åˆ¶å‚æ•°
  51          unsigned char Led_Mode_Dat = 1; //æ¨¡å¼ç¼–å·
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 2   

  52          unsigned char Level = 2;  //ç­‰çº§å‚æ•°(äº®åº¦/ç”µå‹/å…‰æ•/çƒ­æ•/å¤–éƒ¨ç”µå‹)
  53          unsigned char Led_Pos;          //Ledçš„pwmé€‰æ‹©æ§åˆ¶ä½
  54          unsigned char Led_cnt;          //Ledçš„pwmè®¡æ•°å‚æ•°
  55          unsigned int Led_Time;          //Ledæµè½¬æ—¶é—´è®¡æ—¶å‚æ•°
  56          unsigned char k = 0;            //LEDæ˜¾ç¤ºæ‰«æå¾ªç¯å‚æ•°
  57          /*é—ªçƒè®¡æ—¶å‚æ•°(åœ¨LEDæµè½¬ä¸æ¸©åº¦çš„å‚æ•°è®¾ç½®ç•Œé¢å…±ç”¨)*/
  58          unsigned int Time400ms;         //é—ªçƒè®¡æ—¶
  59          bit Shine_Flag;                 //é—ªçƒå‚æ•°
  60          /*é£æ‰‡å¯åœ/å››é€šé“ADè½¬æ¢ç›¸å…³å‚æ•°(å…‰æ•,çƒ­æ•,å˜å‹å™¨,å¤–éƒ¨é€šé“)*/
  61          float Voltage;                  //SPIè¯»å–ADè½¬æ¢ç”µå‹å€¼,è¯¥å€¼å…³è”é£æ‰‡PWMå ç©ºæ¯”,è¿›ä¸€æ­¥æ§åˆ
             -¶é£æ‰‡é€Ÿåº¦
  62          unsigned char Ad_Disp_Choose;   //ADæ˜¾ç¤ºå­ç•Œé¢åˆ‡æ¢å‚æ•° 0-é£æ‰‡ç­‰çº§/ç”µå‹å€¼æ˜¾ç¤ºå­ç•Œé¢ 1-ä
             -º®åº¦å€¼æ˜¾ç¤ºå­ç•Œé¢ 2-ç”µé˜»æ¸©åº¦å€¼æ˜¾ç¤ºå­ç•Œé¢ 3-å¤–éƒ¨ç”µå‹å€¼æ˜¾ç¤ºå­ç•Œé¢
  63          bit Fan_Ctro;                   //é£æ‰‡å¯åœæ§åˆ¶å‚æ•°
  64          /*æ¸©åº¦æ§åˆ¶ç›¸å…³å‚æ•°*/
  65          float Temperature = 25;         //å•æ€»çº¿è¯»å–æ¸©åº¦å€¼
  66          bit Temp_Page_Choose;           //æ¸©åº¦é‡‡é›†ç•Œé¢-->è®¾ç½®ä¸Šä¸‹é™ç•Œé¢ åˆ‡æ¢æŒ‰é”®
  67          bit Temp_Dat_Choose;            //æ¸©åº¦é˜ˆå€¼å‚æ•°æ“ä½œé€‰æ‹©æŒ‰é”®
  68          bit Beep_Ring;                  //æ¸©åº¦å‘Šè­¦å‚æ•°
  69          unsigned char Temp_Max = 30;    //æ¸©åº¦é˜ˆå€¼ä¸Šé™
  70          unsigned char Temp_Min = 20;    //æ¸©åº¦é˜ˆå€¼ä¸‹é™
  71          /*èœ‚é¸£å™¨ç›¸å…³å‚æ•°*/
  72          sbit BEEP=P2^5;                 //èœ‚é¸£å™¨æ¥å£
  73          bit Music_Switch;               //éŸ³ä¹å¯åœå¼€å…³(æŒ‰é”®æ§åˆ¶)
  74          bit Music_Stop;                 //éŸ³ä¹æš‚åœç»§ç»­å¼€å…³
  75          bit flag;                       //éŸ³ä¹å¯åœå¼€å…³(æ ‡å¿—ä½)(0/1-->æ§åˆ¶èœ‚é¸£å™¨å“ä¸ä¸å“)
  76          unsigned int h,i,hz;            //hz-é¢‘ç‡(è¯¥å‚æ•°å¯¹åº”éŸ³è°ƒçš„é¢‘ç‡) h-éŸ³è°ƒ(è¯¥å‚æ•°å¯¹åº”éŸ³è°ƒæ•°ç»„
             -song(do,re,mi,fa...)) i-è®¡æ•°å‚æ•°(æ§åˆ¶éŸ³ä¹çš„è¿›è¡Œ)
  77          unsigned char jiep;             //èŠ‚æ‹å‚æ•°æ§åˆ¶éŸ³ç¬¦çš„æŒç»­æ—¶é—´,åœ¨å®šæ—¶å™¨äºŒä¸­è®¡æ—¶(ä¸€æ¬¡50ms)
  78          unsigned int code G_fre[]={63928,64103,64260,     //#2,4,5 ä½éŸ³
  79          64331,64463,64580,64633,64732,64820,64898,64934 //#5,#6,1,#1,#2,4,5,#5 ä¸­éŸ³
  80          ,0,64777};//#Gè°ƒéŸ³é˜¶ï¼Œæœ€åä¸€ä¸ªä¸ºä¸­éŸ³3
  81          unsigned char code song[]={
  82          1,6,5,3,6,3,5,3,6,3,5,6,1,6,11,12,                                //æˆ‘åº”è¯¥æ‹¿ä½ æ€æ ·
  83          1,6,0,3,1,3,1,3,0,3,1,6,1,6,11,12,                                //æ‰€æœ‰äººéƒ½åœ¨çœ‹ç€æˆ‘
  84          1,3,1,3,6,6,5,3,6,3,5,6,1,6,11,12,                                //æˆ‘çš„å¿ƒæ€»æ˜¯ä¸å®‰
  85          1,6,0,3,1,3,1,3,0,3,1,6,1,6,3,12,                                 //æˆ‘ç°åœ¨å·²ç—…å…¥è†è‚“
  86          6,12,5,12,1,6,1,6,11,6,0,6,1,6,11,6,6,3,6,3,5,3,6,3,5,6,1,6,11,12,//e~oï¼ŒçœŸçš„ï¼Œéš¾é“ï¼Œå› ä½ è€Œç–¯ç‹
             -‚å—
  87          1,6,0,3,1,3,1,3,0,3,1,6,1,6,1,12,11,6,                            //æˆ‘æœ¬æ¥ä¸æ˜¯è¿™ç§äºº
  88          1,6,0,3,1,3,1,3,0,3,1,6,1,6,3,12,                                 //å› ä½ å˜æˆå¥‡æ€ªçš„äºº
  89          10,12,9,12,7,12,5,6,5,6,10,12,9,12,7,6,5,12,7,12,11,6,            //ç¬¬ä¸€æ¬¡å‘€å˜æˆè¿™æ ·çš„æˆ‘
  90          5,3,5,6,5,6,12,6,12,6,12,6,8,6,9,6,                               //ä¸ç®¡æˆ‘æ€ä¹ˆå»å¦è®¤
  91          1,6,5,6,5,6,8,12,11,12,11,12,11,6,1,3,1,6,11,12,                  //é¸¡ä½ å¤ªç¾ï¼Œbaby
  92          1,6,5,6,5,6,8,12,11,12,11,12,11,6,1,3,1,6,11,12,11,12,            //é¸¡ä½ å¤ªç¾ï¼Œbaby
  93          1,6,5,6,5,6,8,12,11,12,11,12,11,6,1,3,1,6,11,12,                  //é¸¡ä½ å¤ªç¾ï¼Œbaby
  94          1,6,5,6,5,6,8,12,11,12,11,12,11,6,1,3,1,6,11,12,11,12,            //é¸¡ä½ å¤ªç¾ï¼Œbaby
  95          5,3,5,3,8,3,5,3,5,3,5,3,5,3,5,3,5,3,4,3,5,6,5,6,                  //è¿é¢èµ°æ¥çš„ä½ è®©æˆ‘å¦‚æ­¤è ¢è ¢æ¬²åŠ¨
  96          5,3,5,3,8,3,5,3,5,3,5,3,5,3,5,3,5,3,4,3,5,6,5,6,                  //è¿™ç§æ„Ÿè§‰æˆ‘ä»æœªæ‹¥æœ‰ï¼Œcause i got a cru
             -sh on you
  97          }; //æ­Œè°± 2ä¸ªä¸€ç»„(0,0)(éŸ³è°ƒ,èŠ‚æ‹(ä¸€æ‹å¯¹åº”å€¼ä¸º12))
  98          
  99          /*èœ‚é¸£å™¨æ’­æ”¾éŸ³ä¹ç›¸å…³å‡½æ•°*/
 100          void sing(){
 101   1        if(Music_Switch){
 102   2          if(flag==1){
 103   3            h=song[i];
 104   3            jiep=song[i+1];
 105   3            i=i+2;
 106   3            if(i>254)
 107   3              i=0;
 108   3            hz=G_fre[h];
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 3   

 109   3            TH1=(hz)/256;
 110   3            TL1=(hz)%256;
 111   3            flag=0;
 112   3            TR2=1;
 113   3            TR1=1;
 114   3          }
 115   2        }
 116   1      }
 117          
 118          void Sing_Init(){//å¼€å…³éŸ³ä¹åˆå§‹åŒ–å‡½æ•°
 119   1        i = 0;
 120   1        TR1 = 0;
 121   1        TR2 = 0;
 122   1      }
 123          
 124          void Sing_Off(){//å¯åœå‡½æ•°-->å…³å®šæ—¶å™¨-->æš‚åœ
 125   1        TR1 = 0;
 126   1        TR2 = 0;
 127   1      }
 128          
 129          void Sing_On(){//å¯åœå‡½æ•°-->å¼€å®šæ—¶å™¨-->æ’­æ”¾
 130   1        TR1 = 1;
 131   1        TR2 = 1;
 132   1      }
 133          /*ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°*/
 134          void Sys_Init(void){
 135   1        TMOD=0x11;                //å®šæ—¶å™¨0å·¥ä½œåœ¨æ¨¡å¼1 å®šæ—¶1ms
 136   1        T2MOD=0;                  //å®šæ—¶å™¨1æ¨¡å¼1 ç”¨ä½œéŸ³è°ƒå‘ç”Ÿå™¨
 137   1        T2CON=0;                  //å®šæ—¶å™¨2å®šæ—¶æ¨¡å¼ å®šæ—¶50ms ç”¨ä½œå»¶éŸ³
 138   1        TL0=(65536 - 1000) % 256; //è®¾ç½®å®šæ—¶ä½å…«ä½åˆå§‹å€¼
 139   1        TH0=(65536 - 1000) / 256; //è®¾ç½®å®šæ—¶é«˜å…«ä½åˆå§‹å€¼
 140   1        TH2=0;
 141   1        TL2=0;
 142   1        TF0=0;
 143   1        TR0=1;
 144   1        ET0=1;
 145   1        ET1=1;
 146   1        ET2=1;
 147   1        EA=1;
 148   1        i=0;
 149   1        flag=1;
 150   1        P1_0 = 0;
 151   1      }
 152          /*ç³»ç»Ÿå…³é—­å‡½æ•°*/
 153          void Sys_Off(void){
 154   1        TF0=0;
 155   1        TR0=0;
 156   1        ET0=0;
 157   1        ET1=0;
 158   1        ET2=0;
 159   1        EA=0;
 160   1        i=0;
 161   1        flag=0;
 162   1        P1_0 = 0;
 163   1        P0 = 0;
 164   1        P2 = 0XFF;
 165   1      }
 166          /*æŒ‰é”®å¤„ç†å‡½æ•°*/
 167          void Key_Proc(){
 168   1        if(System_Begin){
 169   2          if(Key_Slow_Down) return;
 170   2          Key_Slow_Down = 1;
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 4   

 171   2        }
 172   1        Key_Val = Key_Read();
 173   1        Key_Down = Key_Val & (Key_Old ^ Key_Val);
 174   1        Key_Up = ~Key_Val & (Key_Old ^ Key_Val);
 175   1        Key_Old = Key_Val;
 176   1        
 177   1        switch(Key_Down){
 178   2          case 9:
 179   2            if(!System_Begin) Led_Light = ~Led_Light;
 180   2            if(System_Begin) Sys_Off();
 181   2            System_Begin = ~System_Begin;
 182   2            
 183   2          break;
 184   2          case 8://-æŒ‰é”®(å¯¹ä¸€äº›å‚æ•°çš„å‡æ³•æ“ä½œ) å…¼å®¹äº®åº¦ç­‰çº§æ˜¾ç¤º 
 185   2            if(!Led_Dat_Choose && Seg_Disp_Page == 3){
 186   3              if(--Led_Mode_Dat == 0)
 187   3                Led_Mode_Dat = 4;
 188   3                EEPROM_Write(&Led_Mode_Dat,0,1);
 189   3              }
 190   2            if(Led_Dat_Choose && Seg_Disp_Page == 3){
 191   3              Led_Ctro -= 100;
 192   3              if(Led_Ctro < 400) Led_Ctro = 1200;
 193   3            }
 194   2            if(Seg_Disp_Page == 1){
 195   3              Light_Disp = ~Light_Disp;
 196   3            }
 197   2            if(Seg_Disp_Page == 2 && Temp_Page_Choose && !Temp_Dat_Choose){
 198   3              Temp_Min -= 1;
 199   3              if(Temp_Min < 20) Temp_Min = 20;
 200   3              EEPROM_Write(&Temp_Min,2,1);
 201   3            }
 202   2            if(Seg_Disp_Page == 2 && Temp_Page_Choose && Temp_Dat_Choose){
 203   3              Temp_Max -= 1;
 204   3              if(Temp_Max < 20) Temp_Max = 20;
 205   3              EEPROM_Write(&Temp_Max,1,1);
 206   3            }
 207   2          break;
 208   2          case 7://å­ç•Œé¢åˆ‡æ¢æŒ‰é”®å…¼å®¹å‚æ•°è®¾ç½®(å¯¹ä¸Šä¸‹é™ä»¥åŠæµè½¬å‚æ•°çš„è®¾ç½®)
 209   2            if(LED_OR_SEG_OR_BEEP == 1){//ä»…é™åœ¨æ•°ç ç®¡ç•Œé¢è®¾ç½®
 210   3              if(!Led_Page_Choose){     //è‹¥åœ¨æµè½¬å‚æ•°è®¾ç½®ç•Œé¢ï¼Œåˆ™å­ç•Œé¢ä¸åˆ‡æ¢
 211   4                if(++Seg_Disp_Page == 4) Seg_Disp_Page = 0;//å­ç•Œé¢åˆ‡æ¢
 212   4                if(Seg_Disp_Page == 0){ //è¿”å›æ—¶é’Ÿé¦–ç•Œé¢ï¼Œç›¸å…³å‚æ•°ç½®é›¶
 213   5                  Ad_Disp_Choose = 0;   //ADæ˜¾ç¤ºåˆ‡æ¢å‚æ•°ç½®ä¸ºé£æ‰‡ç­‰çº§æ˜¾ç¤ºç•Œé¢
 214   5                  Temp_Dat_Choose = 0;  //æ¸©åº¦é‡‡é›†ä¸Šä¸‹é™è®¾ç½®ç•Œé¢ç½®æ¸©åº¦ä¸Šé™é—ªçƒ
 215   5                  Led_Dat_Choose = 1;   //LEDæµè½¬å‚æ•°è®¾ç½®ç•Œé¢ç½®äº®åº¦ç­‰çº§é—ªçƒ
 216   5                }
 217   4                if(Fan_Ctro){   //è‹¥é£æ‰‡è½¬åŠ¨æ—¶åˆ‡æ¢å­ç•Œé¢,é£æ‰‡åœæ­¢
 218   5                  P1_0 = 0;     //å¼•è„šç½®ä½ç”µå¹³
 219   5                  Fan_Ctro = 0; //é£æ‰‡å¯åœæ§åˆ¶å‚æ•°æ¸…é›¶
 220   5                }
 221   4              }
 222   3              if(Seg_Disp_Page == 3){//æµè½¬å‚æ•°è®¾ç½®ç•Œé¢
 223   4                Led_Dat_Choose = ~Led_Dat_Choose;//å¯¹å‚æ•°ä¸Šä¸‹é™è¿›è¡Œé€‰æ‹©
 224   4              }
 225   3              if(Seg_Disp_Page == 3 && Temp_Page_Choose){
 226   4                Seg_Disp_Page = 2;
 227   4                Temp_Dat_Choose = ~Temp_Dat_Choose;
 228   4              }
 229   3            }
 230   2          break;
 231   2          case 6://+æŒ‰é”®(å¯¹ä¸€äº›å‚æ•°çš„åŠ æ“ä½œ)
 232   2            if(!Led_Dat_Choose && Seg_Disp_Page == 3){
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 5   

 233   3              if(++Led_Mode_Dat >= 5)
 234   3                Led_Mode_Dat = 1;
 235   3              EEPROM_Write(&Led_Mode_Dat,0,1);
 236   3            }
 237   2            if(Led_Dat_Choose && Seg_Disp_Page == 3){
 238   3              Led_Ctro += 100;
 239   3              if(Led_Ctro > 1200) Led_Ctro = 400;
 240   3            }
 241   2            if(Seg_Disp_Page == 2 && Temp_Page_Choose && !Temp_Dat_Choose){
 242   3              Temp_Min += 1;
 243   3              if(Temp_Min > 35) Temp_Min = 35;
 244   3              EEPROM_Write(&Temp_Min,2,1);
 245   3            }
 246   2            if(Seg_Disp_Page == 2 && Temp_Page_Choose && Temp_Dat_Choose){
 247   3              Temp_Max += 1;
 248   3              if(Temp_Max > 35) Temp_Max = 35;
 249   3              EEPROM_Write(&Temp_Max,1,1);
 250   3            }
 251   2          break;
 252   2          case 5://LEDä¸æ•°ç ç®¡åˆ‡æ¢æ˜¾ç¤ºæŒ‰é”®
 253   2            if(LED_OR_SEG_OR_BEEP == 1){//è‹¥ç”¨æˆ·åœ¨å‚æ•°è®¾ç½®ç•Œé¢åˆ‡æ¢æ¨¡å¼ å¯¹ç›¸å…³é—ªçƒå‚æ•°ä»¥åŠç•Œ
             -é¢é€‰æ‹©å‚æ•°æ“ä½œ
 254   3              Seg_Disp_Page = 0;    //è‹¥æ¨¡å¼åˆ‡æ¢ ç½®æ•°ç ç®¡åˆå§‹ç•Œé¢ä¸ºæ—¶é’Ÿé¦–ç•Œé¢
 255   3              Ad_Disp_Choose = 0;   //ADæ˜¾ç¤ºåˆ‡æ¢å‚æ•°ç½®ä¸ºé£æ‰‡ç­‰çº§æ˜¾ç¤ºç•Œé¢
 256   3              Temp_Page_Choose = 0; //æ¸©åº¦ç•Œé¢ç½®æ¸©åº¦æ£€æµ‹ç•Œé¢
 257   3              Temp_Dat_Choose = 0;  //æ¸©åº¦é‡‡é›†ä¸Šä¸‹é™è®¾ç½®ç•Œé¢ç½®æ¸©åº¦ä¸Šé™é—ªçƒ,æ¸©åº¦ä¸‹é™ä¸é—ªçƒ
 258   3              Led_Dat_Choose = 1;   //LEDæµè½¬å‚æ•°è®¾ç½®ç•Œé¢ç½®äº®åº¦ç­‰çº§é—ªçƒ,æµè½¬å‚æ•°ä¸é—ªçƒ
 259   3              Light_Disp = 0;       //ç­‰çº§æ˜¾ç¤ºå‚æ•°æ¸…é›¶ é»˜è®¤ä¸æ˜¾ç¤ºç­‰çº§
 260   3              Led_Page_Choose = 0;  //LEDå‚æ•°ç•Œé¢ç½®LEDæ­£å¸¸æ˜¾ç¤ºç•Œé¢
 261   3            }
 262   2            if(++LED_OR_SEG_OR_BEEP == 3) LED_OR_SEG_OR_BEEP = 0;//æ¨¡å¼åˆ‡æ¢
 263   2            if(Fan_Ctro){//è‹¥é£æ‰‡è½¬åŠ¨æ—¶åˆ‡æ¢å­ç•Œé¢,é£æ‰‡åœæ­¢
 264   3              P1_0 = 0;//å¼•è„šç½®ä½ç”µå¹³
 265   3              Fan_Ctro = 0;//é£æ‰‡å¯åœæ§åˆ¶å‚æ•°æ¸…é›¶
 266   3            }
 267   2          break;
 268   2          case 1://æ•°ç ç®¡æ˜¾ç¤ºæ¨¡å¼æ•°ç ç®¡æ˜¾ç¤ºå­ç•Œé¢åˆ‡æ¢æŒ‰é”®
 269   2            if(Seg_Disp_Page == 1){//ADæ˜¾ç¤ºå­ç•Œé¢åˆ‡æ¢
 270   3              if(++Ad_Disp_Choose == 4) Ad_Disp_Choose = 0;
 271   3            }
 272   2            if(Seg_Disp_Page == 2){//æ¸©åº¦æ£€æµ‹ä¸è®¾ç½®ç•Œé¢åˆ‡æ¢
 273   3              Temp_Page_Choose = ~Temp_Page_Choose;
 274   3            }
 275   2            if(Seg_Disp_Page == 3){//LEDæ­£å¸¸æ˜¾ç¤ºä¸è®¾ç½®ç•Œé¢åˆ‡æ¢
 276   3              Led_Page_Choose = ~Led_Page_Choose;
 277   3            }
 278   2            if(Fan_Ctro){   //è‹¥é£æ‰‡è½¬åŠ¨æ—¶åˆ‡æ¢å­ç•Œé¢,é£æ‰‡åœæ­¢
 279   3              P1_0 = 0;     //å¼•è„šç½®ä½ç”µå¹³
 280   3              Fan_Ctro = 0; //é£æ‰‡å¯åœæ§åˆ¶å‚æ•°æ¸…é›¶
 281   3            }
 282   2          break;
 283   2          case 2://éŸ³ä¹æ’­æ”¾
 284   2            if(LED_OR_SEG_OR_BEEP == 2){
 285   3              if(!Music_Switch) Sing_Init();
 286   3              Music_Switch = ~Music_Switch;
 287   3            }
 288   2          break;
 289   2          case 3://éŸ³ä¹æš‚åœ
 290   2            if(Music_Switch == 1){
 291   3              if(!Music_Stop) Sing_Off();
 292   3              else Sing_On();
 293   3              Music_Stop = ~Music_Stop;
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 6   

 294   3            }
 295   2          break;
 296   2          case 4://é£æ‰‡å¯åŠ¨æŒ‰é”®
 297   2            if(LED_OR_SEG_OR_BEEP == 1 && Seg_Disp_Page == 1){
 298   3              if(Fan_Ctro) P1_0 = 0;
 299   3              Fan_Ctro = ~Fan_Ctro;
 300   3            }
 301   2          break;
 302   2        }
 303   1      }
 304          /*æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°*/
 305          void Seg_Proc(){
 306   1        if(Seg_Slow_Down) return;
 307   1        Seg_Slow_Down = 1;
 308   1        
 309   1        switch(Seg_Disp_Page){
 310   2          case 0:
 311   2            Read_Clk(uc_Rtc);
 312   2            Seg_Buf[0] = uc_Rtc[0] / 16 % 16;
 313   2            Seg_Buf[1] = uc_Rtc[0] % 16;
 314   2            Seg_Buf[2] = 13;
 315   2            Seg_Buf[3] = uc_Rtc[1] / 16 % 16;
 316   2            Seg_Buf[4] = uc_Rtc[1] % 16;
 317   2            Seg_Buf[5] = 13;
 318   2            Seg_Buf[6] = uc_Rtc[2] / 16 % 16;
 319   2            Seg_Buf[7] = uc_Rtc[2] % 16;
 320   2            Seg_Point[2] = 0;
 321   2            Seg_Point[5] = 0;
 322   2          break;
 323   2          case 1:
 324   2            if(Ad_Disp_Choose == 0){
 325   3              Voltage = Read_AD_Data(0x94);//ç”µä½å™¨ADè½¬æ¢å®é™…0~4.93V
 326   3              Level = (unsigned char)(Voltage * 2);//ç­‰çº§ç»†åˆ†0~9çº§   
 327   3              Seg_Buf[0] = 15;
 328   3              Seg_Buf[1] = Light_Disp ? Level <= 3 ? 20 : Level > 6 ? 21 : 13 : 10;        
 329   3              Seg_Buf[2] = Light_Disp ? (unsigned char)Voltage % 10 : 10;        
 330   3              Seg_Buf[3] = Light_Disp ? (unsigned char)(Voltage * 10) % 10 : 10; 
 331   3              Seg_Buf[4] = Light_Disp ? (unsigned char)(Voltage * 100) % 10 : 10;
 332   3              Seg_Buf[5] = 13;
 333   3              Seg_Buf[6] = Level;
 334   3              Seg_Buf[7] = 13;
 335   3              Seg_Point[2] = Light_Disp ? 1 : 0;
 336   3              Seg_Point[5] = 0;
 337   3            } else if(Ad_Disp_Choose == 1){//å…‰æ•ç”µé˜»ADè½¬æ¢å®é™…0~4.93V 0XA4
 338   3              Voltage = Read_AD_Data(0xA4);//ç”µä½å™¨ADè½¬æ¢å®é™…0~4.93V
 339   3              Level = (unsigned char)(Voltage * 2);//ç­‰çº§ç»†åˆ†0~9çº§   
 340   3              Seg_Buf[0] = 17;
 341   3              Seg_Buf[1] = Light_Disp ? 13 : 10;
 342   3              Seg_Buf[2] = Light_Disp ? Level : 10;
 343   3              Seg_Buf[3] = Light_Disp ? 13 : 10;
 344   3              Seg_Buf[4] = 10;
 345   3              Seg_Buf[5] = (unsigned char)Voltage % 10;
 346   3              Seg_Buf[6] = (unsigned char)(Voltage * 10) % 10;
 347   3              Seg_Buf[7] = (unsigned char)(Voltage * 100) % 10;
 348   3              Seg_Point[2] = 0;
 349   3              Seg_Point[5] = 1;
 350   3            } else if(Ad_Disp_Choose == 2){//çƒ­æ•ç”µé˜»ADè½¬æ¢å®é™…0~4.93V 0XD4
 351   3              Voltage = Read_AD_Data(0xD4);//ç”µä½å™¨ADè½¬æ¢å®é™…0~4.93V
 352   3              Level = (unsigned char)(Voltage * 2);//ç­‰çº§ç»†åˆ†0~9çº§   
 353   3              Seg_Buf[0] = 11;
 354   3              Seg_Buf[1] = Light_Disp ? 13 : 10;
 355   3              Seg_Buf[2] = Light_Disp ? Level : 10;
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 7   

 356   3              Seg_Buf[3] = Light_Disp ? 13 : 10;
 357   3              Seg_Buf[4] = 10;
 358   3              Seg_Buf[5] = (unsigned char)Voltage % 10;
 359   3              Seg_Buf[6] = (unsigned char)(Voltage * 10) % 10;
 360   3              Seg_Buf[7] = (unsigned char)(Voltage * 100) % 10;
 361   3              Seg_Point[2] = 0;
 362   3              Seg_Point[5] = 1;
 363   3            } else if(Ad_Disp_Choose == 3){//AIN3ä½ä¸Šçš„ADè½¬æ¢å®é™…0~4.93V 0XE4
 364   3              Voltage = Read_AD_Data(0xE4);//ç”µä½å™¨ADè½¬æ¢å®é™…0~4.93V
 365   3              Level = (unsigned char)(Voltage * 2);//ç­‰çº§ç»†åˆ†0~9çº§   
 366   3              Seg_Buf[0] = 15;
 367   3              Seg_Buf[1] = 0;
 368   3              Seg_Buf[2] = Light_Disp ? 13 : 10;
 369   3              Seg_Buf[3] = Light_Disp ? Level : 10;
 370   3              Seg_Buf[4] = Light_Disp ? 13 : 10;
 371   3              Seg_Buf[5] = (unsigned char)Voltage % 10;
 372   3              Seg_Buf[6] = (unsigned char)(Voltage * 10) % 10;
 373   3              Seg_Buf[7] = (unsigned char)(Voltage * 100) % 10;
 374   3              Seg_Point[2] = 0;
 375   3              Seg_Point[5] = 1;
 376   3            }
 377   2          break;
 378   2          case 2:
 379   2            if(!Temp_Page_Choose){
 380   3              DS18B20_ConvertT();
 381   3              Temperature = DS18B20_ReadT();
 382   3              Seg_Buf[0] = 11;
 383   3              Seg_Buf[1] = 10;
 384   3              Seg_Buf[2] = 10;
 385   3              Seg_Buf[3] = 10;
 386   3              Seg_Buf[4] = (unsigned char)(Temperature / 10) % 10;
 387   3              Seg_Buf[5] = (unsigned char)(Temperature) % 10;
 388   3              Seg_Buf[6] = (unsigned int)(Temperature * 10) % 10;
 389   3              Seg_Buf[7] = (unsigned int)(Temperature * 100) % 10;
 390   3              Seg_Point[2] = 0;
 391   3              Seg_Point[5] = 1;
 392   3            } else{
 393   3              Seg_Buf[0] = 12;
 394   3              Seg_Buf[1] = 13;
 395   3              Seg_Buf[2] = !Temp_Dat_Choose && Shine_Flag ? 10 : Temp_Min / 10 % 10;
 396   3              Seg_Buf[3] = !Temp_Dat_Choose && Shine_Flag ? 10 : Temp_Min % 10;
 397   3              Seg_Buf[4] = 13;
 398   3              Seg_Buf[5] = Temp_Dat_Choose && Shine_Flag ? 10 : Temp_Max / 10 % 10;
 399   3              Seg_Buf[6] = Temp_Dat_Choose && Shine_Flag ? 10 : Temp_Max % 10;
 400   3              Seg_Buf[7] = 13;
 401   3              Seg_Point[2] = 0;
 402   3              Seg_Point[5] = 0;
 403   3            }
 404   2            if(Temperature > Temp_Max){
 405   3              Beep_Ring = 1;
 406   3              Fan_Ctro = 1;
 407   3            } else if(Temperature < Temp_Min){
 408   3              Beep_Ring = 1;
 409   3              Fan_Ctro = 0;
 410   3            } else{
 411   3              Beep_Ring = 0;
 412   3              Fan_Ctro = 0;
 413   3            }
 414   2          break;
 415   2          case 3:
 416   2            if(Led_Page_Choose){
 417   3              Seg_Buf[0] = 13;
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 8   

 418   3              Seg_Buf[1] = !Led_Dat_Choose && Shine_Flag ? 10 : Led_Mode_Dat;
 419   3              Seg_Buf[2] = 13;
 420   3              Seg_Buf[3] = 10;
 421   3              Seg_Buf[4] = Led_Dat_Choose && Shine_Flag ? 10 : Led_Ctro >= 1000 ? Led_Ctro / 1000 % 10 : 10;
 422   3              Seg_Buf[5] = Led_Dat_Choose && Shine_Flag ? 10 : Led_Ctro / 100 % 10;
 423   3              Seg_Buf[6] = Led_Dat_Choose && Shine_Flag ? 10 : Led_Ctro / 10 % 10;
 424   3              Seg_Buf[7] = Led_Dat_Choose && Shine_Flag ? 10 : Led_Ctro % 10;
 425   3              Seg_Point[2] = 0;
 426   3              Seg_Point[5] = 0;
 427   3            } else {//æ­£å¸¸æ˜¾ç¤º
 428   3              Seg_Buf[0] = 13;
 429   3              Seg_Buf[1] = Led_Mode_Dat;
 430   3              Seg_Buf[2] = 13;
 431   3              Seg_Buf[3] = 10;
 432   3              Seg_Buf[4] = Led_Ctro >= 1000 ? Led_Ctro / 1000 % 10 : 10;
 433   3              Seg_Buf[5] = Led_Ctro / 100 % 10;
 434   3              Seg_Buf[6] = Led_Ctro / 10 % 10;
 435   3              Seg_Buf[7] = Led_Ctro % 10;
 436   3              Seg_Point[2] = 0;
 437   3              Seg_Point[5] = 0;
 438   3            }
 439   2          break;
 440   2        }
 441   1      }
 442          /*LEDæ˜¾ç¤ºå‡½æ•°*/
 443          void Led_Proc(){
 444   1        static char k = 0;
 445   1        switch(Led_Mode_Dat){
 446   2          case 1:
 447   2            for(k = 0;k < 8;k++){
 448   3              ucLed[k] = Led_Pos == k ? 1 : 0;
 449   3            }
 450   2          break;
 451   2          case 2:
 452   2            for(k = 0;k < 8;k++){
 453   3              ucLed[k] = Led_Pos == 7 - k ? 1 : 0;
 454   3            }
 455   2          break;
 456   2          case 3:
 457   2            for(k = 0;k < 4;k++){
 458   3              ucLed[k] = ucLed[7 - k] = Led_Pos == 4 + k ? 1 : 0;
 459   3            }
 460   2          break;
 461   2          case 4:
 462   2            for(k = 4;k >= 0;k--){
 463   3              ucLed[k] = ucLed[7 - k] = Led_Pos == k ? 1 : 0;
 464   3            }
 465   2          break;
 466   2        }
 467   1      }
 468          /*å»¶æ—¶å‡½æ•°*/
 469          void Delay750ms(){                //@12.000MHz
 470   1        unsigned char i, j, k;
 471   1      
 472   1        _nop_();
 473   1        i = 6;
 474   1        j = 180;
 475   1        k = 26;
 476   1        do{
 477   2          do{
 478   3            while (--k);
 479   3          }while (--j);
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 9   

 480   2        }while (--i);
 481   1      }
 482          
 483          void Delayxms(unsigned char n){   //@12.000MHz
 484   1        unsigned char i, j;
 485   1        
 486   1        while(n--){
 487   2        i = 2;
 488   2        j = 239;
 489   2          do
 490   2          {
 491   3            while (--j);
 492   3          } while (--i);
 493   2        }
 494   1      }
 495          
 496          /*å¯åŠ¨æ˜¾ç¤ºLEDèŠ±å¼ç‚¹äº®å‡½æ•°*/
 497          void LED_Fancy_Light(){
 498   1        for(i = 0;i < 8;i++){
 499   2          P2 = Led_Wela[0][i];
 500   2          Delayxms(30);
 501   2        }
 502   1        for(i = 0;i < 8;i++){
 503   2          P2 = Led_Wela[0][7-i];
 504   2          Delayxms(50);
 505   2        }
 506   1        for(i = 0;i < 4;i++){
 507   2          P2 = Led_Wela[1][i];
 508   2          Delayxms(80);
 509   2        }
 510   1        for(i = 0;i < 4;i++){
 511   2          P2 = Led_Wela[1][i+4];
 512   2          Delayxms(100);
 513   2        }
 514   1      }
 515          /*ä¸»å‡½æ•°*/
 516          void main(){
 517   1        unsigned char i,py=0,pl=0;
 518   1        P1_0 = 0;
 519   1        P0 = 0;
 520   1        LED_Init();                     //SPI RCLK(P3^5) SRCL(P3^6)åˆå§‹åŒ–
 521   1        EEPROM_Read(&Led_Mode_Dat,0,1); //æ•°æ®è¯»å–å¿…é¡»æ”¾åœ¨ç¨‹åºæœ€å¼€å§‹
 522   1        Delay750ms();                   //ç¨å¾®å»¶æ—¶
 523   1        EEPROM_Read(&Temp_Max,1,1);     //æ¸©åº¦é˜ˆå€¼æ•°æ®è¯»å–
 524   1        EEPROM_Read(&Temp_Min,2,1);     //æ¸©åº¦é˜ˆå€¼æ•°æ®è¯»å–
 525   1        Set_Clk(uc_Rtc);                //æ—¶é’Ÿæ•°æ®åˆå§‹åŒ–
 526   1        Voltage = Read_AD_Data(0x94);   //ä¸Šç”µå…ˆè½¬æ¢ç”µå‹æ•°æ®ï¼Œé˜²æ­¢ç¬¬ä¸€æ¬¡è¯»æ•°æ®é”™è¯¯
 527   1        DS18B20_ConvertT();             //ä¸Šç”µå…ˆè½¬æ¢ä¸€æ¬¡æ¸©åº¦ï¼Œé˜²æ­¢ç¬¬ä¸€æ¬¡è¯»æ•°æ®é”™è¯¯
 528   1        Delay750ms();                   //ç­‰å¾…è½¬æ¢å®Œæˆ
 529   1      
 530   1        while(1){
 531   2          Key_Proc();
 532   2          if(System_Begin){
 533   3            if(Led_Light){
 534   4              LED_Fancy_Light();              //ç¨‹åºå¯åŠ¨æ˜¾ç¤º LEDèŠ±å¼ç‚¹äº®
 535   4              Sys_Init();                     //å¯„å­˜å™¨ä»¥åŠç›¸å…³å‚æ•°åˆå§‹åŒ–  
 536   4              Led_Light = 0;
 537   4            }
 538   3            if(LED_OR_SEG_OR_BEEP == 1){//æ•°ç ç®¡ä½é€‰ç«¯ä¸LEDå› ä¸ºå…±ç”¨P2ç«¯å£ï¼ŒP2ç«¯å£å†²çªï¼Œè¿™é‡Œæ•°
             -ç ç®¡ä¸LEDæ˜¾ç¤ºåˆ†éš”ï¼Œé€šè¿‡æŒ‰é”®K1æ“æ§ã€‚
 539   4              Seg_Proc();//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•° 200msè¿›ä¸€æ¬¡
 540   4              if(Beep_Ring){//èœ‚é¸£å™¨æŠ¥è­¦ä¸å¦
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 10  

 541   5                BEEP = ~BEEP;
 542   5              }
 543   4            } else if(LED_OR_SEG_OR_BEEP == 2){
 544   4              /*åˆå§‹åŒ–æ•°ç ç®¡ï¼Œç­çš„çŠ¶æ€*/
 545   4              Seg_Buf[0] = 10;
 546   4              Seg_Buf[1] = 10;
 547   4              Seg_Buf[2] = 10;
 548   4              Seg_Buf[3] = 10;
 549   4              Seg_Buf[4] = 10;
 550   4              Seg_Buf[5] = 10;
 551   4              Seg_Buf[6] = 10;
 552   4              Seg_Buf[7] = 10;
 553   4              Seg_Point[5] = 0;
 554   4              sing();//èœ‚é¸£å™¨æ’­æ”¾éŸ³ä¹
 555   4              /*LEDç‚¹é˜µå±æ˜¾ç¤ºkunkun*/
 556   4              for(i=0;i<8;i++){
 557   5                LED(i,DH[i+py]);
 558   5              }
 559   4              pl++;
 560   4              if(pl>25){
 561   5                pl=0;
 562   5                py+=8;
 563   5                if(py>10000) py=0;
 564   5              }
 565   4            } else {
 566   4              /*åˆå§‹åŒ–æ•°ç ç®¡ï¼Œç­çš„çŠ¶æ€*/
 567   4              Seg_Buf[0] = 10;
 568   4              Seg_Buf[1] = 10;
 569   4              Seg_Buf[2] = 10;
 570   4              Seg_Buf[3] = 10;
 571   4              Seg_Buf[4] = 10;
 572   4              Seg_Buf[5] = 10;
 573   4              Seg_Buf[6] = 10;
 574   4              Seg_Buf[7] = 10;
 575   4              Seg_Point[5] = 0;
 576   4              /*LEDè½®æµæ˜¾ç¤ºç•Œé¢åŒæ—¶è¿›è¡ŒADè½¬æ¢ï¼Œè¿›è¡ŒPWMè°ƒäº®*/
 577   4              Level = (unsigned char)(Voltage * 2);//ç­‰çº§ç»†åˆ†0~9çº§
 578   4              Voltage = Read_AD_Data(0x94);//ADè½¬æ¢å®é™…0~4.93V
 579   4              Led_Proc();
 580   4            }
 581   3          }
 582   2        }
 583   1      }
 584          /*å®šæ—¶å™¨0æœåŠ¡å‡½æ•°*/
 585          void Timer0_Server() interrupt 1{
 586   1        TL0 = 0x18;   //è®¾ç½®å®šæ—¶åˆå€¼
 587   1        TH0 = 0xFC;   //è®¾ç½®å®šæ—¶åˆå€¼
 588   1        if(++Key_Slow_Down == 10) Key_Slow_Down = 0;
 589   1        if(++Seg_Slow_Down == 200) Seg_Slow_Down = 0;
 590   1        if(LED_OR_SEG_OR_BEEP == 1){
 591   2          if(++Seg_Pos == 8) Seg_Pos = 0;
 592   2          Seg_Disp(Seg_Pos,Seg_Buf[Seg_Pos],Seg_Point[Seg_Pos]);
 593   2            if(Seg_Disp_Page >= 1){
 594   3              if(++Time400ms == 400){
 595   4                Time400ms = 0;
 596   4                Shine_Flag = ~Shine_Flag;
 597   4              }
 598   3            }
 599   2          if(Fan_Ctro){
 600   3            Led_cnt++;
 601   3            if(Seg_Disp_Page == 1 && Ad_Disp_Choose == 0){
 602   4              if(Led_cnt < Level){
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 11  

 603   5                P1_0 = 1;
 604   5              } else if(Led_cnt < 10){
 605   5                P1_0 = 0;
 606   5              } else {
 607   5                Led_cnt = 0;
 608   5              }
 609   4            } else if(Seg_Disp_Page == 2){
 610   4              if(Led_cnt < Temperature - Temp_Max){
 611   5                P1_0 = 1;
 612   5              } else if(Led_cnt < 10){
 613   5                P1_0 = 0;
 614   5              } else {
 615   5                Led_cnt = 0;
 616   5              }
 617   4            }
 618   3          }
 619   2        } else if(LED_OR_SEG_OR_BEEP == 0){
 620   2          Led_Disp(Seg_Pos,ucLed[Seg_Pos]);//LEDæ‰«æåº•å±‚å‡½æ•°åªç‚¹äº®ä¸€æ¬¡ï¼Œéœ€è¦æ‰‹åŠ¨åˆ‡æ¢äº®ç­è°ƒæ•´
             -å ç©ºæ¯”ã€‚
 621   2          if(++Led_Time >= Led_Ctro){
 622   3            if(++Led_Pos == 8){
 623   4              Led_Pos = 0;
 624   4              if(++Led_Mode_Dat == 5){
 625   5                Led_Mode_Dat = 1;
 626   5              }
 627   4              if(Led_Mode_Dat == 3 || Led_Mode_Dat == 4)Led_Pos = 4;
 628   4            }
 629   3            Led_Time = 0;
 630   3          }
 631   2          for(k=0;k<8;k++){
 632   3            if(Led_Pos == k){
 633   4              Led_cnt++;
 634   4              if(Led_cnt < Level){
 635   5                if(Led_Mode_Dat == 1){
 636   6                  P2 = Led_Wela[0][Led_Pos];
 637   6                } else if(Led_Mode_Dat == 2){
 638   6                  P2 = Led_Wela[0][7-Led_Pos];
 639   6                } else if(Led_Mode_Dat == 3){
 640   6                  P2 = Led_Wela[1][Led_Pos - 4];
 641   6                } else {
 642   6                  P2 = Led_Wela[1][Led_Pos];
 643   6                }
 644   5              } else if(Led_cnt < 10){
 645   5                P2 = 0XFF;
 646   5              } else {
 647   5                Led_cnt = 0;
 648   5              }
 649   4            }
 650   3          }
 651   2        }
 652   1      }
 653          /*å®šæ—¶å™¨1æœåŠ¡å‡½æ•°*/
 654          void time1() interrupt 3{
 655   1        TH1=(hz)/256;
 656   1        TL1=(hz)%256;
 657   1        if(!flag)
 658   1          BEEP=!BEEP;
 659   1        else
 660   1          TR1=0;
 661   1      }
 662          
 663          /*å®šæ—¶å™¨2æœåŠ¡å‡½æ•°*/
C51 COMPILER V9.60.0.0   MAIN                                                              06/15/2024 12:47:18 PAGE 12  

 664          void time2() interrupt 5 {
 665   1        RCAP2H=(15536)/256;
 666   1        RCAP2L=(15536)%256;
 667   1        --jiep;
 668   1        if(jiep==0)
 669   1          flag=1;
 670   1        TF2=0;
 671   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3273    ----
   CONSTANT SIZE    =    604    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     82       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =     13    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
